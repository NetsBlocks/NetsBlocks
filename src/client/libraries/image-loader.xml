<blocks app="NetsBlox 0.14.2, http://netsblox.org" version="1"><block-definition collabId="item_51_14" s="load image %&apos;url&apos;" type="reporter" category="operators"><header></header><code></code><inputs><input type="%s"></input></inputs><script><block collabId="item_83" s="doDeclareVariables"><list><l>image</l></list></block><block collabId="item_99" s="doDeclareVariables"><list><l>imageLoader</l></list></block><block collabId="item_97" s="doSetVar"><l>image</l><l>0</l></block><block collabId="item_102" s="doSetVar"><l>imageLoader</l><block collabId="item_51_6" s="reportJSFunction"><list><l>url</l><l>proc</l></list><l>if (!proc.requestedImage) {&#xD;    // Create new request&#xD;    proc.requestedImage = new Image();&#xD;    proc.requestedImage.crossOrigin = &apos;Anonymous&apos;;&#xD;    proc.requestedImage.src = url;&#xD;    proc.requestedImage.onerror = function(event) {&#xD;        proc.requestedImage.error = event;&#xD;    };&#xD;} else if (proc.requestedImage.complete &amp;&amp; proc.requestedImage.naturalWidth) {&#xD;    // Clear request&#xD;    image = proc.requestedImage;&#xD;    proc.requestedImage = null;&#xD;    return new Costume(image, &apos;name&apos;);&#xD;} else if (proc.requestedImage.error) {&#xD;    proc.requestedImage = null;&#xD;    throw Error(&apos;Could not retrieve image&apos;);&#xD;}&#xD;proc.pushContext(&apos;doYield&apos;);&#xD;proc.pushContext();</l></block></block><custom-block collabId="item_72" s="safely try %cs then if %upvar %cs"><script><block collabId="item_89" s="doSetVar"><l>image</l><block collabId="item_64_2" s="evaluate"><block collabId="item_107" var="imageLoader"/><list><block collabId="item_51" var="url"/></list></block></block></script><l>error</l><script><block collabId="item_109" s="doSetVar"><l>image</l><block collabId="item_109_1" s="evaluate"><block collabId="item_109_2" var="imageLoader"/><list><block collabId="item_60" s="reportJoinWords"><list><l>https://crossorigin.me/</l><block collabId="item_109_3" var="url"/></list></block></list></block></block></script></custom-block><block collabId="item_64_1" s="doReport"><block collabId="item_116" var="image"/></block></script></block-definition><block-definition collabId="item_71_71" s="safely try %&apos;action&apos; then if %&apos;error&apos; %&apos;handler&apos;" type="command" category="control"><header></header><code></code><inputs><input type="%cs"></input><input type="%upvar"></input><input type="%cs"></input></inputs><script><custom-block collabId="item_71_63" s="let %upvar be %s"><l>reset</l><block collabId="item_71_61" s="evaluate"><block collabId="item_71_60" s="reportJSFunction"><list><l>proc</l></list><l>var oldHandleError = proc.handleError,&#xD;    oldCatchingErrors = proc.isCatchingErrors;&#xD;&#xD;return function(){&#xD; proc.handleError = oldHandleError;&#xD; proc.isCatchingErrors = oldCatchingErrors;&#xD;}</l></block><list></list></block></custom-block><block collabId="item_71_55" s="doCallCC"><block collabId="item_71_54" s="reifyScript"><script><block collabId="item_71_52" s="doRun"><block collabId="item_71_51" s="reportJSFunction"><list><l>reset</l><l>action</l><l>handler</l><l>proc</l></list><l>proc.isCatchingErrors = true;&#xD;proc.handleError = function(error, element){&#xD; reset();&#xD; proc.context = handler;&#xD; proc.context.variables.setVar("error", error);&#xD;}&#xD;&#xD;try{&#xD; proc.evaluate(action, new List(), true);&#xD;}&#xD;catch(e){&#xD; proc.handleError(e, null);&#xD;} </l></block><list><block collabId="item_71_43" var="reset"/><block collabId="item_71_42" var="action"/><block collabId="item_71_41" s="reifyScript"><script><block collabId="item_71_39" s="doRun"><block collabId="item_71_38" s="reifyScript"><script><block collabId="item_71_36" s="doRun"><block collabId="item_71_35" var="handler"/><list></list></block><block collabId="item_71_33" s="doRun"><block collabId="item_71_32" var="return"/><list></list></block></script><list></list></block><list></list></block></script><list></list></block></list></block></script><list><l>return</l></list></block></block><block collabId="item_71_25" s="doRun"><block collabId="item_71_24" var="reset"/><list></list></block></script></block-definition></blocks>